function [p,sumllik,a1,b1,a2,b2,a0,b0] = cmp2pmfs(data1,data2,abopt)% [p,a1,b1,a2,b2,a0,b0] = cmp2pmfs(data1,data2)% fits 2 psychometric functions and compares them for significance.% the comparison will allow both alpha and beta free for all fits unless a% third argument, abopt, is supplied.  abopt is a 2-vector that is% interepreted as follows.  The fields refer to [alpha beta].  If 0, then it% is free.  If -1 then it is fixed to the value that is obtained under the% null hypothesis fit to the union of data1 and data2.  Any other value is% designated as a fixed parameter.  NOT ALL OPTIONS WORK yet.% 12/5/96 mns wrote it% test%a1 = 10; a2 = 8; b1= 1.2; b2 = 1.3; n=160;%c = [0 2 4 8 16 32]';%p1 = 1- 0.5*exp(-(c/a1).^b1);%p2 = 1- 0.5*exp(-(c/a2).^b2);%data1 =[c binornd(n,p1)/n n*ones(size(c))];%data2 =[c binornd(n,p2)/n n*ones(size(c))];% function begins heredata0 = [data1; data2][data1(:,2) data2(:,2)]% $$$ [q i] = sort(data0(:,1));% $$$ data0 = data0(i,:);% $$$ clist = munique(data0(:,1));% $$$ for i = 1:length(clist)% $$$   d0(i,1) = clist(i);% $$$   L = data0(:,1)==clist(i);% $$$   d0(i,2) =  sum(data0(L,2)) / sum(data0(L,3));% $$$   d0(i,% $$$ xxxx there's a problem here% $$$ [a1,b1,llik1] = quickfit(data1);[a2,b2,llik2] = quickfit(data2);[a0,b0,llik0] = quickfit(data0);[a1 a2 a0]binopdf(data1(:,2).*data1(:,3), data1(:,3),...    1-.5*exp(-((data1(:,1)/a1).^b1)))binopdf(data1(2,2).*data1(2,3), data1(2,3),...    1-.5*exp(-(data1(2,1)/a1).^b1))p1 = data1(2,2).*data1(2,3)p2 = data1(2,3)p3 =  1-.5*exp(-((data1(2,1)/a1).^b1))data1(2,2)binopdf(p1,p2,p3)binopdf(56,100,.57)binopdf(56,100,.57)p1==56p1llik1 =  sum(log(binopdf(floor(data1(:,2).*data1(:,3)), floor(data1(:,3)),...    1-.5*exp(-(data1(:,1)/a1).^b1))))llik2 =  sum(log(binopdf(floor(data2(:,2).*data2(:,3)), floor(data2(:,3)),...    1-.5*exp(-(data2(:,1)/a2).^b2))));llik0 =  sum(log(binopdf(floor(data0(:,2).*data0(:,3)), floor(data0(:,3)),...    1-.5*exp(-(data0(:,1)/a0).^b0))));sumllik = [llik1 llik2 llik0]llik12 = llik1+llik2llik0llik12-llik0p = 1-chi2cdf(2*(llik12-llik0), 2)sum(log(binopdf([1 1 1 0 0 0],1,.5)))log(binopdf(3,6,.5))