function [ci] = rci(r,n,alpha)% ci = rci(r,n,alpha) Confidence interval for correlation coefficient%   r   is r value%   n   number of observations (ordered pairs)% alpha defines percentile as 1-alpha/2  -- default is 0.05 (95% CI).%% from Rosner 4th Ed. p.512, algorithm 11.38% 6/23/99 mns wrote itif nargin < 3  alpha = 0.05;endz = 0.5 * log((1+r)./(1-r));zn = norminv(alpha/2,0,1);z1 = z - zn*sqrt(1./(n-3));z2 = z + zn*sqrt(1./(n-3));rho1 = (exp(2*z1)-1) ./ (exp(2*z1)+1);rho2 = (exp(2*z2)-1) ./ (exp(2*z2)+1);% Return the CI, sorted.  The following expression should work with% vector input.ci = sort([rho1 rho2]')';