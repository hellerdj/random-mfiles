function [muhat,shat,muCI,sCI,b_new,tz,hPoints,hPred] = fitBetterCarpG(t, tmin, tinf)% Uses max likelihood to fit normal to reciprocal of RXTs% Usage:% [muhat,shat,muCI,sCI,b_new,tz,hPoints,hFit,hPred] = ...%     fitBetterCarpGraph(t, tmin, tinf)[muhat,shat,muCI,sCI] = normfit(1000*(1./t),0.05);% We can get back the slope of the Carpenter graph as followsb_new = [0 0]';b_new(2) = -1000/shat;% This is actually the absolute value of the slope% We can get the y-interceptb_new(1) = -muhat * b_new(2) / 1000;T = sort(1./t);cumT = 1 - ((1:length(t)) / length(t));z = norminv(cumT,0,1);% plot(T,cumT)hPoints = plot(T,z,'o','MarkerSize',1);% figure(3)t4pred = [50 100 150 200 300 500 1000 tinf]';zExtrap = [ones(size(t4pred)) 1./t4pred] * b_new;hold onhPred = plot(1./t4pred,zExtrap,'r--','LineWidth',0.5);tz = [t4pred zExtrap];set(gca,'XDir','reverse')set(gca,'XLim',[1./[tinf tmin]])ylim = get(gca,'YLim');set(gca,'YLim',[min([ylim(1) min(zExtrap)]) max([ylim(2) max(zExtrap)])])set(gca,'Xtick',1./t4pred(end:-1:1))q = cellstr(num2str(t4pred));% q = cellstr(t4pred)q{end} = 'inf';set(gca,'XTickLabel',q(end:-1:1))axprefs(gca)ylabel('Value of inverse normal for cdf')xlabel('Reaction time (ms)')