function f = qe2(q,Data)% qe2(lam,Data) used by quickfit.  based on fitfun2 from datdemo.m%% FITFUN2  Used  by DATDEMO to return errors in fitting data to a function.%	FITFUN2 is used by DATDEMO.  FITFUN2(lam,Data) returns the error%	between the data and the values computed by the current%	function of lam.  FITFUN2 assumes a function of the form%%	  y =  c(1)*exp(-lam(1)*t) + ... + c(n)*exp(-lam(n)*t)%%	with n linear parameters and n nonlinear parameters.% [f,g] = quick_err(q)%	New error function to minimize for Quick fits.  f is the negative of%	the log likelihood of obtaining the data under parameters q.  This%	is just like fitfunw.  g provides the constraints.%	The Quick function is.  % -%	  y = 1 - .5 * exp( -(x/lam(1))^lam(2) )% -%	thus q(1) is alpha, and q(2) is beta.%	The data is in columns such that Data(:,1) is abscissa %	Data(:,2) is observed percent correct (0..1)%	Data(:,3) is number of observations.%	The value of err is the -log likelihood of obtaining Data%	given the parameters q.%x = Data(:,1);y = Data(:,2) .* Data(:,3);n = Data(:,3);z = 1 - .5 * exp( -(x/q(1)).^q(2) );L = find(z==1.0);if ~isempty(L)  z(L) = .9999 * ones(size(z(L)));endp = binopdf(y,n,z);f = -sum(log(p));g(1) = -(q(1) + .00001); 				% constrain that alpha > 0g(2) = -q(2);