function S11_2 = condcov(C,J)% CONDCOV calculates the conditional covariance matrix formed from elements% in rows and columns of covariance matrix, C, once holding% constant (i.e., conditional on) those rows and columns specified% by vector J. %	(M N Shadlen, 5/94)a = 1:size(C,1);I = a(~isMember(a',J));S12 = C(I,J);S21 = C(J,I);S11 = C(I,I);S22 = C(J,J);S11_2 = S11 - S12*inv(S22)*S21;