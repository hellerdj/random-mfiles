function S11_2 = condcov(C,J)% CONDCOV calculates the conditional covariance matrix formed from elements% 	in rows and columns of covariance matrix, C, once holding% 	constant (i.e., conditional on) those rows and columns specified% 	by vector J.  The dimensions of the return matrix is length(C) - length(J)% 	Usage: S11_2 = condcov(C,J)%	%	for Ref. see T.W. Anderson, An Introduction to%	Multivariate Statistical Analysis, p.36 (2nd edition)%	(M N Shadlen, 5/94)  a = C;a(J,:) = [];S12 = a(:,J);% S12 = C(I,J);a = C;a(:,J) = [];S21 = a(J,:);a = C;a(J,:) = [];a(:,J) = [];S11 = a;S22 = C(J,J);S11_2 = S11 - S12*inv(S22)*S21;