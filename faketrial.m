function correct = faketrial(x,alpha,beta)% faketrial(x,alpha,beta) simulates trials from a psychometric function %   x is intensity (e.g., contrast or coh)%   alpha is threshold in units of x%   beta is slope of pmf% x can be a vector to represent many trials.  Alpha & beta can either be% specified as matching vectors  or as scalars.% The routine returns binary vector, CORRECT , which is the same size as% x.% 3/23/99 mns wrote itif isscalar(x)  probcorrect = 1 - 0.5*exp(-((x/alpha).^beta));  correct = rand < probcorrect;     % resp keeps a record of correct elseif isvector(x)  if isscalar(alpha)    alpha = repmat(alpha,size(x));  elseif length(alpha)~=length(x)    error('alpha must either be scalar or same size as x')  end  if isscalar(beta)    beta = repmat(beta,size(x));  elseif length(beta)~=length(x)    error('beta must either be scalar or same size as x')  end  probcorrect = 1 - 0.5*exp(-((x./alpha).^beta));  correct = rand(size(x)) < probcorrect;     % resp keeps a record of correct end					 