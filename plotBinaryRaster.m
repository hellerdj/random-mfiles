function [h,sttrl] = plotBinaryRaster(b,t)% [h,sttrl] = plotBinaryRaster(b,t)%	plots a binary style raster.  This is a matrix, B, whose rows represent%	trials and whose values are either 1 or 0.  The second input%	argument is optional.  The user can provide a vector, T, whose%	length matches the width of B, that specifies the time axis%	associated with each bin.  If this is not provided, the default is%	to normalize starting with 0+ to 1. (By 0+ I mean that the 1st time%	is not 0 but 1/size(b,2). %%	The routine returns a handle to the graphics object, h, and an%	m-by-2 array consisting of spike times in column 1 and trial number%	in column 2.  The array will have as many rows as there are 1's in%	the B matrix.%%       M Shadlen, 10/16/94if nargin < 2  % no time vector is given. So make one that starts at 0+ and goes to 1.  t = linspace(1/size(b,2), 1, size(b,2));end% note that a row vector, t, can be copied as rows of a 5-by-length(t)% matrix by the expression, t(ones(5,1),:) st = b .* t(ones(size(b,1),1),:);	% spike times subst for the 1'strl = [1:size(b,1)]';trlmtx = trl(:,ones(1,size(b,2)));sttrl = [st(:) trlmtx(:)];sttrl(st(:) == 0, : ) = [];h = plot(sttrl,'.','MarkerSize',4)