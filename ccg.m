function [g,h] = ccg(x,y,hwidth,res)%	[g,h] = CCG(x,y,hwidth,res)%	g is the cross correlogram between event series x and y from%	-hwidth to +hwidth.  x and y are vectors containing spike%	arrival times. res is resolution.  Usually .001%	h is a vector of bin labels in units of res.%		To get these from a *.ccg file, you must first%		grab by column 1 = 0 or 1.%nx = length(x);ny = length(y);x = round(x/res);	% round the arrival times to nearest unit of our resolutiony = round(y/res);hu = hwidth/res;	% convert to units of resolution, e.g., msech = -hu:hu;g = zeros(size(h));for i = 1:nx  z = y(abs(y-x(i)) <= hu);  if (length(z) >= 1)     z = z-x(i);		% z contains offset wrt x(i)    for j = 1:length(z)	I = find(h == z(j));	% indices for updating the histogram    	g(I) = g(I) + 1;    end  endendh = h * res;% [g;h]