function w = bandpassWN(ntsamples,mcols,samplerate,lo,hi)% w = bandpassWN(ntsamples,mcols,samplerate,lo,hi) Creates bandpass% white noise sample as a column vector or matrix of MCOLS column% vectors. The routine works by making NTSAMPLES from the normal% distribution, N{0,1}, representing NTSAMPLES*SAMPLERATE duration.  The% routine takes the FFT and sets to zero all values outside the band form LO% to HI before returning the inverse FFT.% 1/28/99 mns wrote it% $$$ % testing vals% $$$ ntsamples = 10% $$$ mcols = 2;% $$$ samplerate = 100% $$$ lo = 10% $$$ hi = 20% $$$ error('forgot to comment out testing lines')tdur = ntsamples / samplerate;dt = 1/samplerate;df = 1/tdur;nyq = samplerate/2;tAxis = cumsum([0; repmat(dt,ntsamples-1,1)]);freqAxis = [0:df:nyq-df -nyq:df:-df]';w = normrnd(0,1,ntsamples,mcols);W = fft(w);pb = abs(freqAxis)>=lo & abs(freqAxis)<=hi;% plot(freqAxis,pb)% plot(pb)w = real(ifft(W .* repmat(pb,1,mcols)));% plot(abs(W .* repmat(pb,1,mcols)))% plot(w)