function [rhatML,n,fr]=commseal(s)% [rhatML,n,fr]=commseal(s)% % Commenges and Seal algorithm for change point%% s is spike times.  The algorithm doesn't care what units you use for% time, but the output (rhatML) is in the same units as the spike train you% provide. %% Output% ~~~~~~% rhatML is the max likelihood value for the changepoint -- units of time% n is its rank in the spike sequence (spike number)% fr is a vector matching x, showing the value of the term that % Commenges and Seal maximize% 11/6/96 mns wrote itnspikes = length(s);nisi = nspikes-1;  % there is one less interval than spikes% x is a list of intervals  -- 1st spike no goodx = [diff(s(:))];fr = zeros(nisi,1);for r = 1:nisi-1  fr(r) = ((mean(x(1:r))).^(-r)) * ((mean(x(r+1:nisi))).^(-(nisi-r)));endfr(nisi) =  ((mean(x(1:nisi))).^(-nisi));% The spike is the one corresponding to the max value of fr.% The array is indexed on intervals; so the corresponding spike is % one greater. e.g., if the 1st interval is the change point, then the change % occurred at spike 2.[y n] = max(fr);n = n+1;rhatML = s(n);% plot(x,fr)% subplot(2,1,1), stem(s(2:nspikes),fr)% subplot(2,1,2), stem(s(2:nspikes),logfr)