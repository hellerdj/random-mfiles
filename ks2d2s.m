function [p,d,r1,r2] = ks2d2s(xy1,xy2)% [p,d,r1,r2] = ks2d2s(xy1,xy2)% 2-dimensional Kolmogorov-Smirnov test on 2 samples, based on the numerical% recipes routine of the same name.c   xy1 and xy2 are n by 2 matrices of xy% ordered pairs.  The routine returns the pval under H0 that the 2% distributions are the same.  The 2nd return arg is the K-S d statistic.% The r1 and r2 vals are free.  They are the r-values for xy1 and xy2,% respectively. %% See Numerical Recipes 2nd Ed. p. 649%% related functions: probks.m quadct.m  % 6/5/98 mns wrote itif size(xy1,2)~=2 | size(xy2,2)~=2  error('inputs must be n by 2 matrices')endn1 = size(xy1,1);n2 = size(xy2,1);% Use the points in xy1 as originsd1 = 0;for i = 1:n1  f = quadct(xy1,xy1(i,:));  g = quadct(xy2,xy1(i,:));  d1 = max([d1 abs(f-g)]);end% Use the points in xy2 as originsd2 = 0;for i = 1:n2  f = quadct(xy1,xy2(i,:));  g = quadct(xy2,xy2(i,:));  d2 = max([d2 abs(f-g)]);endd = (d1 + d2) / 2;			% average the K-S statisticssqen = sqrt(n1 * n2 ./ (n1 + n2));r1 = meanR(xy1);r2 = meanR(xy2);rr = sqrt(1 - 0.5*(r1*r1 + r2*r2));p = probks(d*sqen / (1+rr*(0.25-0.75./sqen)));