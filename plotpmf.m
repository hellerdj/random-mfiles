function [pa,pb, hfit,hpoints, hax] = plotpmf(data1, ha, dotopt, lineopt)% plotpmf(data1, ha)  fits a Weibul function to data and plots on axes % with handle ha.  data1 is 3 columns (coh  prop_correct N)% plotopt is a matlab string for color and line, e.g., 'r-'%% returns alpha, beta% handle to graph, handle to axes% History% ?????  wrote it?% 7/29/96  added the plotopt and return args% new version 8/20/97% globalhdr% dthandlehdrif nargin < 2  ha = gca;elseif nargin > 2  warning('plotpmf ignores the last two args -- sorry')end[pa pb] = quickfit(data1);hpoints = plot(data1(:,1), data1(:,2), 'ko','MarkerFaceColor','k')hold onnzcoh = data1((data1(:,1)>0),1);c = logspace(log10(min(nzcoh)), log10(max(nzcoh)),100);w = 1 - .5*exp(-(c./pa).^pb);hfit = plot(c,w,'k-')hax = gca;set(gca,'XScale','log','YLim',[.4 1]);set(gca, 'TickDir', 'out','Box', 'off','FontSize',14)txtx = text(1,0,'Motion strength (% coherence)');set(gca,'XLabel', txtx);set(txtx,'VerticalAlignment','top','FontSize',18);txty = text(0,0,'Proportion correct');set(gca,'YLabel',txty);set(txty, 'FontSize', 18);s1 = sprintf('alpha = %s', pa);s2 = sprintf('beta = %s', pb);s = sprintf('Threshold %.2f   Slope %.2f', pa,pb)title(s)% bannerTool(s,12)  