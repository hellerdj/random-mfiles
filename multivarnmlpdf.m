function p = multivarnormpdf(x,u,C)% MULTIVARNORMPDF multivariate normal probability density function%   computes probability of obtaining the row vector X%   from the normal pdf with mean vector u and covariance matrix C%% test datas1 = 1; s2 = 2; u = [0 1]; r = .25C = [s1^2 r*s1*s2; r*s1*s2 s2^2]x = [0 1]x = [x; x]X = x'    % routine starts hereu = u(:)'; 				% make sure u is a row vectoru = u(:); 				% make sure u is a row vectorU = u(:,ones(1,size(X,1)))size(u)help tricksif size(x,1) ~= 1 | size(x) ~= size(u)  % this is either a column vector, or it is a scalar  error('multivarnormpdf.m: x must be a row vector with same length as u');end((2*pi)^(-.5*length(u)) / sqrt(det(C))) * exp(-.5 * (X -  U)' * inv(C) *  (X - U))'  help det