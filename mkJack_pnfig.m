function y = mkJack_pnfig(x1, pArange, socrange, r)%	MKJACK_PNFIG(x1,pArange,socrange,r) %		**** This is the special program to handle other ranges of gain_lo%			and hi for use in Jack%		makes a thres and soc v. pooling noise figure%		set x1 to an array like xekw %			in ~mike/rocsim/kong/fig/Analysis.log%		pArange and socrange are vectors whose low and high values%			define the ranges for dithered target regions%		r is a two valued vector used to define the range of%			correlations used to extract values.%%% notice that x1(:,10) has the gain_hi field.  We need to look at this on Jack because% I did some runs with gain_hi = .5 in order to simulate a predominance of less sensitive % cells.clf;subplot(2,1,2)hf = fill([0 0 1 1 0],[min(socrange) max(socrange) max(socrange) min(socrange) min(socrange)], 1 * ones(1,5))hold on;set(hf,'EraseMode','background')set(hf,'FaceColor',[.5 .5 .5])subplot(2,1,1)hf = fill([0 0 1 1 0],[min(pArange) max(pArange) max(pArange) min(pArange) min(pArange)], 1 * ones(1,5))set(hf,'EraseMode','background')set(hf,'FaceColor',[.5 .5 .5])hold on;%% Choose n>128, gainlo > .9% for gainlo = .9sprintf('The following lines will be combined for the gainlo >= .9')x2 = x1(x1(:,1)>=128 & x1(:,2)>=.9 & x1(:,2)<=1 &  x1(:,4)<=max(r) & x1(:,4)>=min(r) & x1(:,10)>.9 ,:)x3 = combinedups(x2,3,9);[d I] = sort(x3(:,3));x9 = x3(I,:)subplot(2,1,1)h1 = plot(x9(:,3), x9(:,6)/10), hold on;ylabel('Threshold (% dots)')subplot(2,1,2)h1 = plot(x9(:,3), x9(:,7)), hold on;ylabel('SOC area')xlabel('Pooling noise (variance/mean)')%%% for gainlo = .5sprintf('The following lines will be combined for the gainlo >= .5')x2 = x1(x1(:,1)>=128 & x1(:,2)>=.49 & x1(:,2)<=.51  & x1(:,4)<=max(r) & x1(:,4)>=min(r) & x1(:,10)>.9  ,:)x3 = combinedups(x2,3,9);[d I] = sort(x3(:,3));x5 = x3(I,:)subplot(2,1,1)h1 = plot(x5(:,3), x5(:,6)/10, '--');subplot(2,1,2)h1 = plot(x5(:,3), x5(:,7),'--');%%% for gainlo = .1sprintf('The following lines will be combined for the gainlo <= .1')x2 = x1(x1(:,1)>=128 & x1(:,2)<=.1 & x1(:,4)<=max(r) & x1(:,4)>=min(r) & x1(:,10)>.9  ,:)x3 = combinedups(x2,3,9);[d I] = sort(x3(:,3));x01 = x3(I,:)subplot(2,1,1)h1 = plot(x01(:,3), x01(:,6)/10, '-.');subplot(2,1,2)h1 = plot(x01(:,3), x01(:,7), '-.');%%%% Special to Jack: for gainlo = .1 and gain_hi = .5%%   note also that we use r = .04 - .05 regardless of what we specifysprintf('The following lines will be combined for the gainlo <= .1')x2 = x1(x1(:,1)>=128 & x1(:,2)<=.1 & x1(:,4)<=.05 & x1(:,4)>=.04 & x1(:,10)==.5  ,:)x3 = combinedups(x2,3,9);[d I] = sort(x3(:,3));x015 = x3(I,:)subplot(2,1,1)h1 = plot(x015(:,3), x015(:,6)/10, ':');subplot(2,1,2)h1 = plot(x015(:,3), x015(:,7), ':');%% add the dotted lines for observed meanssubplot(2,1,1)hl1 = line([0 1], [pArange(2) pArange(2)])set(hl1,'LineStyle', ':')subplot(2,1,2)hl2 = line([0 1], [socrange(2) socrange(2)])set(hl2,'LineStyle', ':')axis([0 1 .5 .65])subplot(2,1,1)txt = sprintf('N = 128  for mean single unit threshold %d %d %d and %d', round(mean(x9(:,5))/10), round(mean(x5(:,5))/10),round(mean(x01(:,5))/10),round(mean(x015(:,5))/10))title(txt)