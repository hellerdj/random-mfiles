function y = probitf(b,x,optoride)% y = probitf(b,x) returns the probit function evaluated at the points in x.%     b is a vector of parameters, defined as follows %      For the FULL MODEL (option 1)%	b(1:2) linear regress coeffs for  mean (center of the function)%	b(3:4) linear regress coeffs for stdev (slope of ogive)%	b(5:6) linear regress coeffs for base offset.  %       b(7:8) linear regress coeffs for asymptote%     For the NULL MODEL (option 2)%        mike, fill in%     For the NOBIAS MODEL (option 3)%        mike, fill in%  each row of x is an observation.  The columns form the design mtx:%     x has 3 columns.  The first col is 1's%     col2 should contain the coregressor of interest (e.g., coh)%     col3 should contain the main regressor (e.g. time) % specify model by setting the global variable probitoption or by sending an% optional 3rd argument% 3/6/98 mns added option 3 and optorideglobal probitoption global probitdf data yobsb = b(:);% To test if coh matters.  Run a version in which the coh column is % Here is the full model in which coh can affect everything.if nargin>2  probitoption = optoride;endif isempty(probitoption)  error('Option must be set using arg3 or the global variable probitoption')endswitch probitoption  case 1    % full model linear effects on mean stdev base and asymptote    % $$$     y = x(:,[1 2])*b([5 6]) + ...    % $$$ 	(x(:,[1 2])*b([7 8])-x(:,[1 2])*b([3 4])) .* ...    % $$$ 	normcdf(x(:,3),x(:,[1 2])*b(1:2),x(:,[1 2])*b(3:4));    y = x(:,[1 2])*b([5 6]) + ...	(x(:,[1 2])*b([7 8])-x(:,[1 2])*b([5 6])) .* ...	normcdf(x(:,3),x(:,[1 2])*b(1:2),x(:,[1 2])*b(3:4));    % size(x(:,[1 2])*b([5 6]))    probitdf = 8;  case 2    % null hypoth, 4 params free. No coregressor effect.    y = b(3)*x(:,1) + (b(4)-b(3))* x(:,1) .* ...	normcdf(x(:,3),b(1),b(2));    probitdf = 4;  case 3    % no bias (base) effects, but linear effects on mean stdev and asymptote    % we are removing the 6th term from the full model.    y = x(:,1)*b(5) + (x(:,[1 2])*b([6 7]) - x(:,1)*b(5)) .* ...	normcdf(x(:,3),x(:,[1 2])*b(1:2),x(:,[1 2])*b(3:4));    probitdf = 7;  otherwise    error('bad option')end