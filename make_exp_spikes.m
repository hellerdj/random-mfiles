function exp_spikes = make_exp_spikes(spike_rate,duration)%exp_spike = make_exp_spikes(spike_rate,duration)%%Generates a spike trian using inter-spike-intervals drown from%an exponential distribution. %%Inputs: spike_rate				mean firing rate (spikes/second)%        duration         duration of spike sequence%%Output: exp_spikes				vector of times (msec) when spikes%													occur.%%				 if spike_rate is a vector, the spike train is divided%        evenly blocks with different firing rates.  If duration%        is a vector of the size of spike_rate, duration is the%        duration for each mean spike_rate.%7/8/96		gmb		Wrote it.% 12/13/96 mns fixed bugexp_spikes=[];start=0;if length(duration)==1  duration=ones(1,length(spike_rate))*duration/length(spike_rate);endfor i=1:length(spike_rate)  nspikes=duration(i)*(spike_rate(i)+sqrt(3*spike_rate));  mu=1000/spike_rate(i);    uniform_ISI = rand(1,nspikes);  exp_ISI = expinv(uniform_ISI,mu);  exp_sum = cumsum(exp_ISI);  exp_sum=exp_sum(exp_sum<duration(i)*1000);  exp_spikes=[exp_spikes exp_sum+start];  start=start+duration(i)*1000;end