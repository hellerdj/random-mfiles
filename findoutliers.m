function [L,s] = findoutliers(x,crit)% [L,s] = findoutliers(x,crit)% given vector x, each element is converted to units of standard deviates% with respect to the rest of the vector, with said element removed. The% function returns these values as the 2nd output arg.  It returns a% boolean array, L, which is 1 if s exceed the criterion number of standard% deviates, crit.  That is, it identifies the outliers.  If x is% a matrix, then this is done for every column.  Note, we use nanmean and% nanstd in this routine.  So empty cells can be included as NaN values.% 12/26/96 mns wrote itif nargin < 2  error('findoutliers requires 2 input arguments')end[m n] = size(x);if n==1  x = x(:);				% ensure columnendm = size(x,1);if m<4  sprintf('Warning: too few observations to remove outliers')  L = ones(m,1);  s = (x-mean(x))/std(x);  return;ends = nan* ones(size(x));for i = 1:m  % form q. it will be x without the current row  q = x;  q(i,:) = [];  s(i,:) = (x(i,:)-nanmean(q)) / nanstd(q);endL = abs(s) > crit;