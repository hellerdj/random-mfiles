function [g,h] = ccgN(s0,s1,hwidth,res,ntrials)%	[g,h] = CCG(s0,s1,hwidth,res,ntrials)%	g is the cross correlogram between event series x and y from%	-hwidth to +hwidth. filll this in mike%	arrival times. res is resolution.  Usually .001%	h is a vector of bin labels in units of res.%		To get these from a *.ccg file, you must first%		grab by column 1 = 0 or 1.%	%% x = [.001 .003 .007]% y = [.001 .005 .006 .009]% res = .001hu = hwidth/res		% convert to units of resolution, e.g., msech = -hu:hu;% g = zeros(size(h));size(h)gg = zeros(ntrials,size(h,2));for k = 1:ntrials  x = s0(k,s0(k,:)~=0);	% delete the zero terms  y = s1(k,s1(k,:)~=0);  x = round(x/res);	% round the arrival times to nearest unit of our resolution  y = round(y/res);  nx = length(x);  ny = length(y);  for i = 1:nx    z = y(abs(y-x(i)) <= hu);    if (length(z) >= 1)       z = z-x(i);		% z contains offset wrt x(i)      for j = 1:length(z)	I = find(h == z(j));	% indices for updating the histogram    	gg(k,I) = gg(k,I) + 1;      end    end  endend% g = sum(gg)/sum(s0(:)~=0);% g = sum(gg)/(ntrials * res);g = sum(gg)/(sum(s0(:)~=0) * res);h = h * res;% [g;h]% bar(h,g)